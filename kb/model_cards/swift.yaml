id: swift
name: SwiFT
modality: brain
domain: fmri
summary: >-
  Swin Transformer for 4D fMRI (3D spatial × temporal) with Lightning training
  loops, contrastive/self-supervised options, and datamodule utilities for UKB,
  HCP, and ABCD cohorts.
arch:
  type: Swin Transformer 4D
  backbone: project/module/models/swin_transformer_4d.py
  parameters: 80M (default config)
  context_length: 17766400  # 96×96×96 voxels × 20 frames
  special_features:
    - Windowed attention along spatial + temporal axes
    - PyTorch Lightning trainer with contrastive options
    - DataModule encapsulates normalization + splitting
tokenizer:
  type: 4D patch embedding (windowed Swin)
context_length: 17766400
checkpoints:
  - name: contrastive_pretrained.ckpt
    path: external_repos/swift/pretrained_models/contrastive_pretrained.ckpt
repo: https://github.com/Transconnectome/SwiFT
weights:
  artifacts:
    - external_repos/swift/pretrained_models/contrastive_pretrained.ckpt
license:
  code: Apache-2.0
  weights: Apache-2.0
  data: UKB/HCP/ABCD restricted
datasets:
  - ukb_fmri_tensor
  - hcp_fmri_tensor
tasks:
  - contrastive_pretraining
  - classification (sex, site)
  - regression (cognition)
intended_use:
  - "adult gene–brain alignment"
  - "developmental / neurodevelopmental prediction"
  - "multimodal brain–omics alignment"
embedding_recipe:
  level: subject
  unit:
    rsfmri:
      - segment
      - run
  pipeline:
    rsfmri:
      reference_strategy: rsfmri_swift_segments_v1
      segment_embedding:
        frames: 20
        stride: 20
        pooling: mean_tokens
        layer: last_hidden_state
      run_aggregation: mean_over_segments
      subject_aggregation: mean_over_runs
      preprocessing:
        - "z-score within CV fold"
        - "residualize(age, sex, site, mean_FD, DVARS)"
      projector:
        type: PCA
        output_dim: 512
      harmonization_hooks:
        - none_baseline
        - site_unlearning_module
  sources:
    - docs/code_walkthroughs/swift_walkthrough.md#integration-hooks
    - external_repos/swift/project/module/pl_classifier.py
  genetics_alignment_notes: |
    Export 512-D subject vectors (post-PCA) to pair with `genetics_gene_fm_pca512_v1`
    in CCA/prediction configs. Document chosen strategy via
    `embedding_strategies.rs_fmri_swift_segments_v1`.
  developmental_notes: |
    SwiFT’s segment→run→subject aggregation is conceptually compatible with developmental rs-fMRI, but pediatric
    motion and varying scan lengths may necessitate different segment lengths and stricter low-motion filtering.
    For Cha and similar cohorts, treat rsfmri_swift_segments_v1 as a starting point and log any age-specific
    adjustments (e.g., segment duration, FD thresholds) in embedding_strategies.
how_to_infer:
  training: |
    python external_repos/swift/project/main.py \
      --dataset_name UKB --downstream_task sex \
      --image_path /mnt/ukb_fmri --loggername tensorboard --project_name swift_baseline
  inference: |
    python external_repos/swift/project/main.py \
      --dataset_name UKB --test_only --test_ckpt_path pretrained_models/contrastive_pretrained.ckpt
inference_api:
  provider: local
  endpoint: external_repos/swift/project/main.py
  input_format: torch tensor directory produced by preprocessing pipeline
  output: task-level predictions + embeddings (via lightning callbacks)
integrations:
  - ukb_genetics_brain_alignment
  - rag_neurogenomics
tags:
  - swin
  - fmri
  - contrastive
  - lightning
verified: false
last_updated: 2025-11-15
notes: >-
  Use sample_scripts/sample_script.sh as a template for interactive jobs; for Slurm
  clusters run sample_script.slurm with correct NEPTUNE credentials.
